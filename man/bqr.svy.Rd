% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bqr.svy.R
\name{bqr.svy}
\alias{bqr.svy}
\title{Bayesian Weighted Quantile Regression (Survey Design)}
\usage{
bqr.svy(
  formula,
  weights = NULL,
  data = NULL,
  quantile = 0.5,
  method = c("ald", "score", "approximate"),
  prior = NULL,
  niter = 50000,
  burnin = 10000,
  thin = 1,
  ...
)
}
\arguments{
\item{formula}{An object of class \code{\link{formula}} specifying the model.}

\item{weights}{Optional survey weights. Can be a numeric vector of length equal
to the number of observations, or a one-sided formula referring to a variable
in \code{data}.}

\item{data}{An optional \code{data.frame} containing the variables in the model.
If not supplied, variables are taken from \code{\link{environment}(formula)}.}

\item{quantile}{Numeric scalar in (0, 1) giving the quantile level \eqn{\tau}.}

\item{method}{Character string; one of \code{"ald"}, \code{"score"}, or
\code{"approximate"} indicating which MCMC kernel to use.}

\item{prior}{A list containing at least \code{b0} and \code{B0}. Defaults to
\code{\link{prior_default}(p)}. For \code{"approximate"}, can also include
\code{w_scale}.}

\item{niter}{Integer; total number of MCMC iterations.}

\item{burnin}{Integer; number of burn-in iterations to discard.}

\item{thin}{Integer; thinning interval for MCMC samples.}

\item{...}{Additional arguments passed to internal functions (currently unused).}
}
\value{
An object of class \code{"bqr.svy"} and \code{"bwqr_fit"}, which is a
list containing:
\describe{
\item{\code{beta}}{Posterior mean estimates of regression coefficients.}
\item{\code{draws}}{Matrix of posterior draws.}
\item{\code{accept_rate}}{Average acceptance rate (if available).}
\item{\code{n_chains}}{Number of MCMC chains.}
\item{\code{warmup}}{Number of warmup iterations.}
\item{\code{thin}}{Thinning interval.}
\item{\code{runtime}}{Elapsed runtime in seconds.}
\item{\code{call}}{Matched call.}
\item{\code{method}}{Method used.}
\item{\code{quantile}}{Quantile level estimated.}
\item{\code{prior}}{Prior specification used.}
\item{\code{terms}}{Model terms object.}
\item{\code{model}}{Model frame.}
\item{\code{formula}}{Model formula.}
}
}
\description{
Fits a Bayesian quantile regression model with survey weights using one of
three MCMC kernels implemented in C++:
\itemize{
\item \code{.MCMC_BWQR_AL} – Asymmetric Laplace Distribution
\item \code{.MCMC_BWQR_SL} – Score likelihood
\item \code{.MCMC_BWQR_AP} – Approximate likelihood
}
Only a single quantile can be estimated at a time.
}
\details{
This function acts as a high-level interface to compiled C++ MCMC routines for
Bayesian quantile regression under complex survey weights. The \code{"ald"} and
\code{"score"} kernels use normalized weights; the \code{"approximate"} kernel
uses raw weights and an additional \code{w_scale} parameter in the prior.
}
\examples{
set.seed(1)
sim <- simulate_bqr_data(n = 50)
fit <- bqr.svy(y ~ x1 + x2, weights = sim$weights, data = sim$data,
               quantile = 0.5, method = "ald", niter = 2000, burnin = 500)
summary(fit)

}
\seealso{
\code{\link{mo.bqr.svy}} for multiple-output quantile regression,
\code{\link{simulate_bqr_data}} for data simulation.
}
