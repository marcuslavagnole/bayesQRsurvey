% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_quantile.R
\name{drawQuantileRegion}
\alias{drawQuantileRegion}
\title{Draw quantile regions (2D) for mo.bqr.svy using convex hulls}
\usage{
drawQuantileRegion(
  fit,
  datafile = NULL,
  response = c("Y1", "Y2"),
  xValue = NULL,
  paintedArea = FALSE,
  comparison = FALSE,
  print_plot = TRUE,
  show_data = !is.null(datafile),
  facet_by_tau = TRUE,
  facet_nrow = 1,
  facet_ncol = NULL,
  facet_scales = "fixed",
  round_digits = 10,
  main = NULL
)
}
\arguments{
\item{fit}{\code{mo.bqr.svy} object with \code{response_dim = 2}.}

\item{datafile}{Optional \code{data.frame} with observed responses to overlay.}

\item{response}{Character vector of length 2 naming the Y columns in
\code{datafile}, e.g. \code{c("Y1","Y2")}.}

\item{xValue}{Predictor values at which to evaluate the region. Can be:
\itemize{
\item \code{NULL}: uses the mean design vector (all zeros).
\item \code{data.frame}: one or more rows specifying predictor settings.
\item \code{list} of data.frames: each element is one row of predictors.
}}

\item{paintedArea}{Logical; if \code{TRUE}, fills the polygon; if \code{FALSE},
only draws the outline.}

\item{comparison}{Logical; if \code{TRUE} and multiple \code{xValue}s are provided,
colors polygons by each \code{xValue}.}

\item{print_plot}{Logical; if \code{TRUE} returns a \pkg{ggplot} object;
if \code{FALSE} returns a \code{data.frame} with polygon coordinates.}

\item{show_data}{Logical; if \code{TRUE} and valid \code{datafile}/\code{response}
are provided, overlays observed points.}

\item{facet_by_tau}{Logical; if \code{TRUE}, facets the plot by quantile level,
creating one panel per \eqn{\tau}.}

\item{facet_nrow}{Number of rows in the facet grid.}

\item{facet_ncol}{Number of columns in the facet grid (if \code{NULL}, computed automatically).}

\item{facet_scales}{Scales option passed to \code{facet_wrap} (\code{"fixed"},
\code{"free"}, etc.).}

\item{round_digits}{Integer, number of digits to round projected points before
computing convex hulls (helps remove duplicates).}

\item{main}{Main title for the plot. If \code{NULL}, a default is constructed.}
}
\value{
Either a \pkg{ggplot2} object (if \code{print_plot = TRUE}) showing
the quantile regions, or a \code{data.frame} with polygon coordinates
(if \code{print_plot = FALSE}).
}
\description{
This function visualizes bivariate quantile regions from a fitted
\code{mo.bqr.svy} object. For each requested quantile level, a convex hull is
computed from the directional points and drawn as a closed polygon. The
function can overlay observed data, compare multiple predictor values, and
facet the plot so each quantile level is displayed in its own panel.
}
\details{
Internally, the function computes directional projections of the fitted model
via \code{.collect_points_for_tau}, applies a convex hull with
\code{grDevices::chull}, and then arranges the vertices to form closed polygons.
This ensures smooth and convex quantile regions. Multiple quantiles can be
visualized simultaneously using faceting.
}
\examples{
\dontrun{
# Fit a bivariate model
fit2 <- mo.bqr.svy(cbind(Y1,Y2) ~ x, data=df2,
                   weights=df2$w, quantile=c(0.5,0.8))

# Draw quantile regions with observed points
drawQuantileRegion(fit2, datafile=df2, response=c("Y1","Y2"),
                   xValue=data.frame(x=c(-1,0,1)),
                   paintedArea=FALSE, comparison=TRUE,
                   facet_by_tau=TRUE)
}
}
\keyword{internal}
